<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./img/favicon.png">
    <title>Meme Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&display=swap');

        body {
            background-color: #0F172A;
            color: #E2E8F0;
            font-family: 'Space Grotesk', sans-serif;
            overflow-x: hidden;
            min-height: 100vh;
        }

        #canvas-container {
            width: 100%;
            max-width: 600px; 
            margin: 0 auto;
            position: relative;
        }
        
        #memeCanvas {
            border: 2px solid #6366F1;
            border-radius: 1rem;
            width: 100%;
            height: auto;
            background: #1e293b;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .input-styled {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 0.5rem;
            color: white;
            transition: all 0.3s ease;
        }

        .input-styled:focus {
            border-color: #6366F1;
            outline: none;
            box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.2);
        }

        .label-meta {
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            color: #94a3b8;
        }

        /* Custom Slider Styling */
        input[type=range] {
            height: 6px;
            -webkit-appearance: none;
            background: #334155;
            border-radius: 3px;
            width: 100%;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 18px;
            width: 18px;
            border-radius: 50%;
            background: #6366F1;
            cursor: pointer;
            border: 2px solid #ffffff;
        }
    </style>
</head>
<body class="p-4 md:p-8 lg:p-12">

    <div class="max-w-6xl mx-auto">
        <header class="mb-10 text-center lg:text-left">
            <h1 class="text-4xl font-extrabold tracking-tight text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-teal-400">
                MEME GENERATOR
            </h1>
            <p class="label-meta mt-2">Vibe Studio Edition â€¢ Manual Text Positioning</p>
        </header>

        <div class="grid lg:grid-cols-12 gap-10">
            
            <!-- Preview Column -->
            <div class="lg:col-span-7 space-y-6">
                <div id="canvas-container">
                    <canvas id="memeCanvas" width="800" height="800"></canvas>
                </div>
                <div class="hidden lg:block p-4 rounded-xl bg-slate-800/50 border border-white/5 text-center">
                    <p class="text-sm text-slate-400">ðŸŽ¨ <span class="font-bold text-teal-400">Pro Tip:</span> Paste an image (Ctrl+V) directly to upload.</p>
                </div>
            </div>

            <!-- UI Column -->
            <div class="lg:col-span-5">
                <div class="bg-slate-800/80 backdrop-blur-md border border-white/10 p-6 rounded-2xl shadow-2xl space-y-8">
                    
                    <!-- Media Section -->
                    <div class="space-y-3">
                        <label class="label-meta">1. Select Base Image</label>
                        <input type="file" id="imageUpload" accept="image/*" class="w-full text-xs text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-indigo-600 file:text-white bg-slate-900 p-2 rounded-lg cursor-pointer">
                    </div>

                    <!-- Top Text Section -->
                    <div class="space-y-4 p-4 bg-slate-900/50 rounded-xl border border-white/5">
                        <label class="label-meta text-indigo-400">2. Top Text</label>
                        <input type="text" id="topText" placeholder="ENTER TOP TEXT HERE" class="input-styled w-full p-3 text-lg font-bold uppercase">
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span class="text-[9px] uppercase text-slate-500 font-bold">Vertical Position</span>
                                <span id="topYVal" class="text-[10px] text-indigo-400 font-bold">15%</span>
                            </div>
                            <input type="range" id="topY" min="0" max="100" value="15">
                        </div>
                    </div>

                    <!-- Bottom Text Section -->
                    <div class="space-y-4 p-4 bg-slate-900/50 rounded-xl border border-white/5">
                        <label class="label-meta text-teal-400">3. Bottom Text</label>
                        <input type="text" id="bottomText" placeholder="ENTER BOTTOM TEXT HERE" class="input-styled w-full p-3 text-lg font-bold uppercase">
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span class="text-[9px] uppercase text-slate-500 font-bold">Vertical Position</span>
                                <span id="botYVal" class="text-[10px] text-teal-400 font-bold">85%</span>
                            </div>
                            <input type="range" id="bottomY" min="0" max="100" value="85">
                        </div>
                    </div>

                    <!-- Appearance -->
                    <div class="grid grid-cols-2 gap-6">
                        <div class="space-y-2">
                            <label class="label-meta">Text Size</label>
                            <input type="range" id="textSize" min="20" max="150" value="60">
                        </div>
                        <div class="space-y-2">
                            <label class="label-meta">Text Color</label>
                            <input type="color" id="textColor" value="#ffffff" class="w-full h-8 bg-transparent cursor-pointer">
                        </div>
                    </div>

                    <!-- Export -->
                    <div class="pt-4 space-y-3">
                        <button id="downloadBtn" class="w-full bg-lime-500 hover:bg-lime-400 text-slate-900 py-4 rounded-xl font-black text-sm uppercase tracking-widest transition shadow-lg shadow-lime-500/20 active:scale-95">
                            Download Meme ðŸ”¥
                        </button>
                        <button id="resetBtn" class="w-full bg-slate-900 text-slate-500 py-2 rounded-xl text-[10px] font-bold uppercase tracking-widest hover:text-white transition">
                            Reset Canvas
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        (function() {
            const canvas = document.getElementById('memeCanvas');
            const ctx = canvas.getContext('2d');
            const topIn = document.getElementById('topText');
            const botIn = document.getElementById('bottomText');
            const topY = document.getElementById('topY');
            const botY = document.getElementById('bottomY');
            const textSize = document.getElementById('textSize');
            const textColor = document.getElementById('textColor');
            const imageIn = document.getElementById('imageUpload');

            let bg = null;
            const CANVAS_SIZE = 800;

            function drawMeme() {
                // Background
                ctx.fillStyle = '#1e293b';
                ctx.fillRect(0, 0, CANVAS_SIZE, CANVAS_SIZE);

                if (bg) {
                    const ratio = Math.max(CANVAS_SIZE / bg.width, CANVAS_SIZE / bg.height);
                    const w = bg.width * ratio;
                    const h = bg.height * ratio;
                    ctx.drawImage(bg, (CANVAS_SIZE - w) / 2, (CANVAS_SIZE - h) / 2, w, h);
                } else {
                    ctx.fillStyle = '#334155';
                    ctx.textAlign = 'center';
                    ctx.font = 'bold 20px Space Grotesk';
                    ctx.fillText('SELECT OR PASTE AN IMAGE', CANVAS_SIZE/2, CANVAS_SIZE/2);
                }

                // Text Setup
                const fontSize = parseInt(textSize.value);
                ctx.font = `900 ${fontSize}px Space Grotesk, sans-serif`;
                ctx.fillStyle = textColor.value;
                ctx.strokeStyle = 'black';
                ctx.lineWidth = fontSize / 6;
                ctx.lineJoin = 'round';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                const tText = topIn.value.toUpperCase();
                const bText = botIn.value.toUpperCase();

                // Top Text
                if (tText) {
                    const ty = (topY.value / 100) * CANVAS_SIZE;
                    ctx.strokeText(tText, CANVAS_SIZE/2, ty);
                    ctx.fillText(tText, CANVAS_SIZE/2, ty);
                    document.getElementById('topYVal').textContent = topY.value + '%';
                }

                // Bottom Text
                if (bText) {
                    const by = (botY.value / 100) * CANVAS_SIZE;
                    ctx.strokeText(bText, CANVAS_SIZE/2, by);
                    ctx.fillText(bText, CANVAS_SIZE/2, by);
                    document.getElementById('botYVal').textContent = botY.value + '%';
                }
            }

            // Input Listeners
            [topIn, botIn, topY, botY, textSize, textColor].forEach(el => {
                el.addEventListener('input', drawMeme);
            });

            // Image Loader
            imageIn.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) handleFile(file);
            });

              // Paste Listener - Enhanced
            window.addEventListener('paste', (e) => {
                const items = (e.clipboardData || e.originalEvent.clipboardData).items;
                for (let index in items) {
                    const item = items[index];
                    if (item.kind === 'file' && item.type.startsWith('image/')) {
                        const blob = item.getAsFile();
                        handleFile(blob);
                        break;
                    }
                }
            });


            function handleFile(file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    const img = new Image();
                    img.onload = () => { bg = img; drawMeme(); };
                    img.src = event.target.result;
                };
                reader.readAsDataURL(file);
            }

            // Buttons
            document.getElementById('downloadBtn').addEventListener('click', () => {
                const link = document.createElement('a');
                link.download = `vibe-meme-${Date.now()}.png`;
                link.href = canvas.toDataURL();
                link.click();
            });

            document.getElementById('resetBtn').addEventListener('click', () => {
                bg = null; topIn.value = ""; botIn.value = ""; drawMeme();
            });

            // Init
            drawMeme();
        })();
    </script>
</body>
</html>